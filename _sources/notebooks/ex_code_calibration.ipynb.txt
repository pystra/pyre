{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "51fad553-7640-431b-a253-970c3052c71d",
   "metadata": {},
   "source": [
    "# Code Calibration\n",
    "\n",
    "Using examples from Sorensen, J.D. (2004), *Notes in Structural Reliability Theory And Risk Analysis*."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "4d56f265-32d8-4004-a0d5-86073dae6dec",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pystra as pr\n",
    "import numpy as np\n",
    "from scipy.optimize import fsolve, minimize\n",
    "from matplotlib import pyplot as plt\n",
    "import pandas as pd\n",
    "from scipy.stats import gumbel_r"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2d69046a-4cd2-44c3-8267-aed9c2455130",
   "metadata": {},
   "outputs": [],
   "source": [
    "def calibration(reliability_func,Xk,beta_t,output=False,xtol=1e-4,**kwargs):\n",
    "    \"\"\"\n",
    "    Generic reliability calibration function.\n",
    "    \n",
    "    Inputs:\n",
    "    - reliability_func: callable accepting nominal values Xk and returning a Form object\n",
    "    - Xk: initial values of the nominal variables\n",
    "    - beta_t: the target reliability index\n",
    "    - output: diagnostic output\n",
    "    - kwargs: additional args to be passed to reliability_func\n",
    "    Return:\n",
    "    - X_opt: the values of the nominal variables at beta_t\n",
    "    - form: the form object at the target reliability index\n",
    "    \"\"\"\n",
    "    def obj_func(Xk,beta_t):\n",
    "        form = reliability_func(Xk,**kwargs)        \n",
    "        if output:\n",
    "            print(f\"{Xk=} | β = {form.getBeta()} | α = {form.getAlpha()} | x* = {form.getDesignPoint(False)}\")\n",
    "        return beta_t - form.beta\n",
    "    \n",
    "    Xk_opt = fsolve(obj_func,x0=Xk,args=(beta_t),xtol=xtol)\n",
    "    form = reliability_func(Xk_opt,**kwargs)\n",
    "    return Xk_opt,form"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "ebe9f2ac-afd2-437f-af84-4c4b2f312df6",
   "metadata": {},
   "outputs": [],
   "source": [
    "def print_form_results(form):\n",
    "    print(f\"β = {form.getBeta()} | α = {form.getAlpha()} | x* = {form.getDesignPoint(False)}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "162f2cf5-07c0-47ad-9766-29089fec3b4e",
   "metadata": {},
   "outputs": [],
   "source": [
    "def sample_maxima(dist,n,n_sample=1000):\n",
    "    \"\"\"\n",
    "    Sample the distribution of the maximum of n samples from a pystra `dist` object.\n",
    "    \n",
    "    Inputs:\n",
    "    dist: the pystra distribution object from which samples of maxima are sought\n",
    "    n: the block size from which to take the maximum\n",
    "    n_samples: the number of samples to produce\n",
    "    \"\"\"\n",
    "    x = dist.sample(n*n_sample).reshape(n,n_sample)\n",
    "    x_max = np.max(x,axis=0)\n",
    "    return x_max"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cf1c7a80-9997-4a66-921e-719e11f16ee9",
   "metadata": {},
   "outputs": [],
   "source": [
    "def sample_minima(dist,n,n_sample=1000):\n",
    "    \"\"\"\n",
    "    Sample the distribution of the minimum of n samples from a pystra `dist` object.\n",
    "    \n",
    "    Inputs:\n",
    "    dist: the pystra distribution object from which samples of minima are sought\n",
    "    n: the block size from which to take the minimum\n",
    "    n_samples: the number of samples to produce\n",
    "    \"\"\"\n",
    "    x = dist.sample(n*n_sample).reshape(n,n_sample)\n",
    "    x_min = np.min(x,axis=0)\n",
    "    return x_min"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60ca2001-7e10-4772-a825-9061e59990c9",
   "metadata": {},
   "source": [
    "## Partial Factors\n",
    "\n",
    "### Example 1\n",
    "\n",
    "Taken from Sorensen (2004), Example 1, pp.141-2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "82aec900-7836-487d-8dc5-f975a23f9885",
   "metadata": {},
   "outputs": [],
   "source": [
    "def lsf(z,R,G,Q):\n",
    "    return z*R - (G + Q)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "6d7087f1-3193-4492-81f1-12a09ec0427c",
   "metadata": {},
   "outputs": [],
   "source": [
    "def reliability(z=10.0,V=0.2):\n",
    "    ls = pr.LimitState(lsf)\n",
    "    sm = pr.StochasticModel()\n",
    "    sm.addVariable(pr.Constant(\"z\", z))\n",
    "    sm.addVariable(pr.Lognormal(\"R\", 1.0,0.15))\n",
    "    sm.addVariable(pr.Normal(\"G\", *2*np.array([1, 0.1])))\n",
    "    sm.addVariable(pr.Gumbel(\"Q\",*3*np.array([1,V])))\n",
    "    \n",
    "    form = pr.Form(sm,ls)\n",
    "    form.run()\n",
    "    \n",
    "    return form"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "2a046fc4-ff21-4662-b077-c49b42192c4d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style type=\"text/css\">\n",
       "</style>\n",
       "<table id=\"T_1f100\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th class=\"blank level0\" >&nbsp;</th>\n",
       "      <th id=\"T_1f100_level0_col0\" class=\"col_heading level0 col0\" >β_T</th>\n",
       "      <th id=\"T_1f100_level0_col1\" class=\"col_heading level0 col1\" >V</th>\n",
       "      <th id=\"T_1f100_level0_col2\" class=\"col_heading level0 col2\" >z</th>\n",
       "      <th id=\"T_1f100_level0_col3\" class=\"col_heading level0 col3\" >λ_q</th>\n",
       "      <th id=\"T_1f100_level0_col4\" class=\"col_heading level0 col4\" >r*</th>\n",
       "      <th id=\"T_1f100_level0_col5\" class=\"col_heading level0 col5\" >g*</th>\n",
       "      <th id=\"T_1f100_level0_col6\" class=\"col_heading level0 col6\" >q*</th>\n",
       "      <th id=\"T_1f100_level0_col7\" class=\"col_heading level0 col7\" >γR</th>\n",
       "      <th id=\"T_1f100_level0_col8\" class=\"col_heading level0 col8\" >γG</th>\n",
       "      <th id=\"T_1f100_level0_col9\" class=\"col_heading level0 col9\" >γQ</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n",
       "      <td id=\"T_1f100_row0_col0\" class=\"data row0 col0\" >3.800</td>\n",
       "      <td id=\"T_1f100_row0_col1\" class=\"data row0 col1\" >0.200</td>\n",
       "      <td id=\"T_1f100_row0_col2\" class=\"data row0 col2\" >11.256</td>\n",
       "      <td id=\"T_1f100_row0_col3\" class=\"data row0 col3\" >1.518</td>\n",
       "      <td id=\"T_1f100_row0_col4\" class=\"data row0 col4\" >0.702</td>\n",
       "      <td id=\"T_1f100_row0_col5\" class=\"data row0 col5\" >2.078</td>\n",
       "      <td id=\"T_1f100_row0_col6\" class=\"data row0 col6\" >5.820</td>\n",
       "      <td id=\"T_1f100_row0_col7\" class=\"data row0 col7\" >1.103</td>\n",
       "      <td id=\"T_1f100_row0_col8\" class=\"data row0 col8\" >1.039</td>\n",
       "      <td id=\"T_1f100_row0_col9\" class=\"data row0 col9\" >1.278</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n",
       "      <td id=\"T_1f100_row1_col0\" class=\"data row1 col0\" >4.300</td>\n",
       "      <td id=\"T_1f100_row1_col1\" class=\"data row1 col1\" >0.200</td>\n",
       "      <td id=\"T_1f100_row1_col2\" class=\"data row1 col2\" >12.747</td>\n",
       "      <td id=\"T_1f100_row1_col3\" class=\"data row1 col3\" >1.518</td>\n",
       "      <td id=\"T_1f100_row1_col4\" class=\"data row1 col4\" >0.675</td>\n",
       "      <td id=\"T_1f100_row1_col5\" class=\"data row1 col5\" >2.080</td>\n",
       "      <td id=\"T_1f100_row1_col6\" class=\"data row1 col6\" >6.531</td>\n",
       "      <td id=\"T_1f100_row1_col7\" class=\"data row1 col7\" >1.145</td>\n",
       "      <td id=\"T_1f100_row1_col8\" class=\"data row1 col8\" >1.040</td>\n",
       "      <td id=\"T_1f100_row1_col9\" class=\"data row1 col9\" >1.434</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n",
       "      <td id=\"T_1f100_row2_col0\" class=\"data row2 col0\" >4.800</td>\n",
       "      <td id=\"T_1f100_row2_col1\" class=\"data row2 col1\" >0.200</td>\n",
       "      <td id=\"T_1f100_row2_col2\" class=\"data row2 col2\" >14.462</td>\n",
       "      <td id=\"T_1f100_row2_col3\" class=\"data row2 col3\" >1.518</td>\n",
       "      <td id=\"T_1f100_row2_col4\" class=\"data row2 col4\" >0.649</td>\n",
       "      <td id=\"T_1f100_row2_col5\" class=\"data row2 col5\" >2.081</td>\n",
       "      <td id=\"T_1f100_row2_col6\" class=\"data row2 col6\" >7.306</td>\n",
       "      <td id=\"T_1f100_row2_col7\" class=\"data row2 col7\" >1.192</td>\n",
       "      <td id=\"T_1f100_row2_col8\" class=\"data row2 col8\" >1.040</td>\n",
       "      <td id=\"T_1f100_row2_col9\" class=\"data row2 col9\" >1.604</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n",
       "      <td id=\"T_1f100_row3_col0\" class=\"data row3 col0\" >3.800</td>\n",
       "      <td id=\"T_1f100_row3_col1\" class=\"data row3 col1\" >0.300</td>\n",
       "      <td id=\"T_1f100_row3_col2\" class=\"data row3 col2\" >13.367</td>\n",
       "      <td id=\"T_1f100_row3_col3\" class=\"data row3 col3\" >1.778</td>\n",
       "      <td id=\"T_1f100_row3_col4\" class=\"data row3 col4\" >0.740</td>\n",
       "      <td id=\"T_1f100_row3_col5\" class=\"data row3 col5\" >2.053</td>\n",
       "      <td id=\"T_1f100_row3_col6\" class=\"data row3 col6\" >7.840</td>\n",
       "      <td id=\"T_1f100_row3_col7\" class=\"data row3 col7\" >1.046</td>\n",
       "      <td id=\"T_1f100_row3_col8\" class=\"data row3 col8\" >1.026</td>\n",
       "      <td id=\"T_1f100_row3_col9\" class=\"data row3 col9\" >1.470</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n",
       "      <td id=\"T_1f100_row4_col0\" class=\"data row4 col0\" >4.300</td>\n",
       "      <td id=\"T_1f100_row4_col1\" class=\"data row4 col1\" >0.300</td>\n",
       "      <td id=\"T_1f100_row4_col2\" class=\"data row4 col2\" >15.468</td>\n",
       "      <td id=\"T_1f100_row4_col3\" class=\"data row4 col3\" >1.778</td>\n",
       "      <td id=\"T_1f100_row4_col4\" class=\"data row4 col4\" >0.712</td>\n",
       "      <td id=\"T_1f100_row4_col5\" class=\"data row4 col5\" >2.054</td>\n",
       "      <td id=\"T_1f100_row4_col6\" class=\"data row4 col6\" >8.966</td>\n",
       "      <td id=\"T_1f100_row4_col7\" class=\"data row4 col7\" >1.086</td>\n",
       "      <td id=\"T_1f100_row4_col8\" class=\"data row4 col8\" >1.027</td>\n",
       "      <td id=\"T_1f100_row4_col9\" class=\"data row4 col9\" >1.681</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row5\" class=\"row_heading level0 row5\" >5</th>\n",
       "      <td id=\"T_1f100_row5_col0\" class=\"data row5 col0\" >4.800</td>\n",
       "      <td id=\"T_1f100_row5_col1\" class=\"data row5 col1\" >0.300</td>\n",
       "      <td id=\"T_1f100_row5_col2\" class=\"data row5 col2\" >17.890</td>\n",
       "      <td id=\"T_1f100_row5_col3\" class=\"data row5 col3\" >1.778</td>\n",
       "      <td id=\"T_1f100_row5_col4\" class=\"data row5 col4\" >0.684</td>\n",
       "      <td id=\"T_1f100_row5_col5\" class=\"data row5 col5\" >2.054</td>\n",
       "      <td id=\"T_1f100_row5_col6\" class=\"data row5 col6\" >10.187</td>\n",
       "      <td id=\"T_1f100_row5_col7\" class=\"data row5 col7\" >1.131</td>\n",
       "      <td id=\"T_1f100_row5_col8\" class=\"data row5 col8\" >1.027</td>\n",
       "      <td id=\"T_1f100_row5_col9\" class=\"data row5 col9\" >1.910</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row6\" class=\"row_heading level0 row6\" >6</th>\n",
       "      <td id=\"T_1f100_row6_col0\" class=\"data row6 col0\" >3.800</td>\n",
       "      <td id=\"T_1f100_row6_col1\" class=\"data row6 col1\" >0.400</td>\n",
       "      <td id=\"T_1f100_row6_col2\" class=\"data row6 col2\" >15.581</td>\n",
       "      <td id=\"T_1f100_row6_col3\" class=\"data row6 col3\" >2.037</td>\n",
       "      <td id=\"T_1f100_row6_col4\" class=\"data row6 col4\" >0.761</td>\n",
       "      <td id=\"T_1f100_row6_col5\" class=\"data row6 col5\" >2.040</td>\n",
       "      <td id=\"T_1f100_row6_col6\" class=\"data row6 col6\" >9.820</td>\n",
       "      <td id=\"T_1f100_row6_col7\" class=\"data row6 col7\" >1.017</td>\n",
       "      <td id=\"T_1f100_row6_col8\" class=\"data row6 col8\" >1.020</td>\n",
       "      <td id=\"T_1f100_row6_col9\" class=\"data row6 col9\" >1.607</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row7\" class=\"row_heading level0 row7\" >7</th>\n",
       "      <td id=\"T_1f100_row7_col0\" class=\"data row7 col0\" >4.300</td>\n",
       "      <td id=\"T_1f100_row7_col1\" class=\"data row7 col1\" >0.400</td>\n",
       "      <td id=\"T_1f100_row7_col2\" class=\"data row7 col2\" >18.295</td>\n",
       "      <td id=\"T_1f100_row7_col3\" class=\"data row7 col3\" >2.037</td>\n",
       "      <td id=\"T_1f100_row7_col4\" class=\"data row7 col4\" >0.733</td>\n",
       "      <td id=\"T_1f100_row7_col5\" class=\"data row7 col5\" >2.040</td>\n",
       "      <td id=\"T_1f100_row7_col6\" class=\"data row7 col6\" >11.362</td>\n",
       "      <td id=\"T_1f100_row7_col7\" class=\"data row7 col7\" >1.056</td>\n",
       "      <td id=\"T_1f100_row7_col8\" class=\"data row7 col8\" >1.020</td>\n",
       "      <td id=\"T_1f100_row7_col9\" class=\"data row7 col9\" >1.859</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_1f100_level0_row8\" class=\"row_heading level0 row8\" >8</th>\n",
       "      <td id=\"T_1f100_row8_col0\" class=\"data row8 col0\" >4.800</td>\n",
       "      <td id=\"T_1f100_row8_col1\" class=\"data row8 col1\" >0.400</td>\n",
       "      <td id=\"T_1f100_row8_col2\" class=\"data row8 col2\" >21.428</td>\n",
       "      <td id=\"T_1f100_row8_col3\" class=\"data row8 col3\" >2.037</td>\n",
       "      <td id=\"T_1f100_row8_col4\" class=\"data row8 col4\" >0.703</td>\n",
       "      <td id=\"T_1f100_row8_col5\" class=\"data row8 col5\" >2.041</td>\n",
       "      <td id=\"T_1f100_row8_col6\" class=\"data row8 col6\" >13.028</td>\n",
       "      <td id=\"T_1f100_row8_col7\" class=\"data row8 col7\" >1.100</td>\n",
       "      <td id=\"T_1f100_row8_col8\" class=\"data row8 col8\" >1.020</td>\n",
       "      <td id=\"T_1f100_row8_col9\" class=\"data row8 col9\" >2.132</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x7f9aa66b5300>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.DataFrame(columns=['β_T', 'V', 'z', 'λ_q', 'r*','g*','q*','γR','γG','γQ'])\n",
    "\n",
    "for V in [0.2,0.3,0.4]:\n",
    "    for beta_t in [3.8,4.3,4.8]:\n",
    "        z, form = calibration(reliability,Xk=15.0,beta_t=beta_t,V=V)\n",
    "        R,G,Q = form.model.getMarginalDistributions()\n",
    "        Rk = R.ppf(0.05)\n",
    "        Gk = G.ppf(0.5)\n",
    "        Qk = Q.ppf(0.98)\n",
    "        Xk = np.array([Rk,Gk,Qk])\n",
    "        Xstar = form.getDesignPoint(False)\n",
    "        γ = Xstar/Xk\n",
    "\n",
    "        df.loc[len(df.index)] = [beta_t, V, z[0], Qk/Q.mean,*Xstar,1/γ[0],*γ[1:]]\n",
    "\n",
    "df.style.format('{:.3f}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "11fbaf25-1513-46d3-b674-1eb880c448fd",
   "metadata": {},
   "source": [
    "## Load Combinations"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "567eef62-d982-47bd-90a2-0c6b4bcabde1",
   "metadata": {},
   "source": [
    "### Example 2\n",
    "Taken from Sorensen (2004), Example 4, pp.190-1. Notes: \n",
    "\n",
    "1. The loads described as $Q_1$ and $Q_2$, are not the point-in-time loads, but the annual maxima distributions, from which the point-in-time loads are to be inferred.\n",
    "2. There is an error in the textbook, and the wind load $Q_2$ is not taken as occurring $r_2 = 360$ times per year as stated, but instead $r_2=2$ per year. \n",
    "\n",
    "Only with these adaptations, do the results match."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "93bb2196-3ea6-4d5a-9c10-9aff7df49674",
   "metadata": {},
   "outputs": [],
   "source": [
    "def lsf(z,R,G,Q1,Q2):\n",
    "    return z*R - (0.4*G + 0.6*Q1 + 0.3*Q2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "434797c0-a31a-42e1-9f44-c965437ad320",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Point-in-time & annual max distributions\n",
    "Q1max = pr.Gumbel(\"Q1\",1,0.2)\n",
    "Q2max = pr.Gumbel(\"Q2\",1,0.4)\n",
    "# Parameters of inferred parents\n",
    "Q1pit = pr.Gumbel(\"Q1\",0.89, 0.2)\n",
    "Q2pit = pr.Gumbel(\"Q2\",0.77, 0.4)\n",
    "# Using new Parent distribution from pystra (not yet merged)\n",
    "#Q1pit = pr.Parent(\"Q1\",Q1max,2)\n",
    "#Q2pit = pr.Parent(\"Q2\",Q2max,2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "824a31b8-c1e0-4722-924e-21dac8b1b01d",
   "metadata": {},
   "outputs": [],
   "source": [
    "def reliability(z=1.0,lc=1):\n",
    "    ls = pr.LimitState(lsf)\n",
    "    sm = pr.StochasticModel()\n",
    "    sm.addVariable(pr.Constant(\"z\", z))\n",
    "    sm.addVariable(pr.Lognormal(\"R\", 1.0,0.15))\n",
    "    sm.addVariable(pr.Normal(\"G\", 1, 0.1))\n",
    "    \n",
    "    # Choose distribution depending on load case\n",
    "    if lc == 2:\n",
    "        sm.addVariable(Q1pit)\n",
    "        sm.addVariable(Q2max) \n",
    "    else:\n",
    "        sm.addVariable(Q1max)\n",
    "        sm.addVariable(Q2pit)\n",
    "    \n",
    "    form = pr.Form(sm,ls)\n",
    "    form.run()\n",
    "    \n",
    "    return form"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "f4610f5e-838e-4e34-9a2b-f9fb4f37a091",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "β = 4.2999999997675875 | α = [-0.64155965  0.08627279  0.53896114  0.53896114] | x* = [0.65528626 1.03713177 1.62355976 2.01711952]\n"
     ]
    }
   ],
   "source": [
    "lc = 1\n",
    "Rk_1, form_1 = calibration(reliability,Xk=3.0,beta_t=4.3,lc=lc)\n",
    "print_form_results(form_1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "2f864085-c752-49e8-8907-cc03e708fe6f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "β = 4.299999999615988 | α = [-0.64216869  0.08625869  0.53859949  0.53859949] | x* = [0.65502999 1.0371257  1.51291126 2.24582252]\n"
     ]
    }
   ],
   "source": [
    "lc = 2\n",
    "Rk_2, form_2 = calibration(reliability,Xk=3.0,beta_t=4.3,lc=lc)\n",
    "print_form_results(form_2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "3eddd5f4-b907-45ca-94be-da16a5cbbe2c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1.51845518, 2.03691035])"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Qk = np.array([Q1max.ppf(0.98),Q2max.ppf(0.98)])\n",
    "Qk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d904cbc5-d1ed-447f-aab0-19e387449a19",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1.62355976, 1.51291126],\n",
       "       [2.01711952, 2.24582252]])"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Q_star = np.array([ form_1.getDesignPoint(False)[-2:], form_2.getDesignPoint(False)[-2:] ]).T\n",
    "Q_star"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "8141b08f-97e0-4ded-a681-3898319b44c7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1.0692181 , 0.99634898],\n",
       "       [0.9902839 , 1.10256326]])"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "γ = Q_star/Qk[:,None]\n",
    "γ"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "f77ad3b5-5ee3-4cdb-ada5-ae820d231c27",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1.        , 0.90366604],\n",
       "       [0.92617577, 1.        ]])"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ψ = γ/np.diag(γ)\n",
    "ψ"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c730f46a-f331-4882-8d50-ca5377d1bcae",
   "metadata": {},
   "source": [
    "### Tuning of Sorensen's parameters\n",
    "\n",
    "Because of the error in the textbook, quite a bit of exploratory work was needed to find the cause."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "17f82e5c-dc06-493e-9c9d-f0b84d9600ef",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "def reliability2(z,x):\n",
    "    ls = pr.LimitState(lsf)\n",
    "    sm = pr.StochasticModel()\n",
    "    sm.addVariable(pr.Constant(\"z\", z))\n",
    "    sm.addVariable(pr.Lognormal(\"R\", 1.0,0.15))\n",
    "    sm.addVariable(pr.Normal(\"G\", 1, 0.1))\n",
    "    \n",
    "    # To find Sorensen's parameters\n",
    "    Q1max = pr.Gumbel(\"Q1\",1,0.2)\n",
    "    Q2max = pr.Gumbel(\"Q2\",1,0.4)\n",
    "    \n",
    "    # Opt = 0.57917817, 0.42796312\n",
    "    # 0.89089033, 0.19967346\n",
    "    #Q1pit = pr.Gumbel(\"Q1\",x[0],x[1])\n",
    "    #sm.addVariable(Q1pit)\n",
    "    #sm.addVariable(Q2max)\n",
    "    \n",
    "    # Opt = 0.77089986, 0.40104018\n",
    "    # 0.57917817, 0.42796312\n",
    "    Q2pit = pr.Gumbel(\"Q2\",x[0],x[1])\n",
    "    sm.addVariable(Q1max)\n",
    "    sm.addVariable(Q2pit)    \n",
    "    \n",
    "    form = pr.Form(sm,ls)\n",
    "    form.run()\n",
    "    \n",
    "    return form"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "bca040d4-831b-4ddf-b326-4ba8e1a58d74",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "x=array([0.5, 0.4]) | x_star=array([0.66232795, 1.03729168, 1.64100382, 1.78200764]) | diff=array([ 0.02100382, -0.24799236])\n",
      "x=array([0.525, 0.4  ]) | x_star=array([0.66166597, 1.03727721, 1.63939433, 1.80378866]) | diff=array([ 0.01939433, -0.22621134])\n",
      "x=array([0.5 , 0.42]) | x_star=array([0.66544148, 1.03626096, 1.54713615, 2.07118623]) | diff=array([-0.07286385,  0.04118623])\n",
      "x=array([0.525, 0.42 ]) | x_star=array([0.66478769, 1.0362482 , 1.54608407, 2.0918623 ]) | diff=array([-0.07391593,  0.0618623 ])\n",
      "x=array([0.5 , 0.44]) | x_star=array([0.66930354, 1.03509884, 1.46600765, 2.35300155]) | diff=array([-0.15399235,  0.32300155])\n",
      "x=array([0.51875, 0.41   ]) | x_star=array([0.66327997, 1.03677549, 1.59243344, 1.94129855]) | diff=array([-0.02756656, -0.08870145])\n",
      "x=array([0.49375, 0.41   ]) | x_star=array([0.66393778, 1.03678912, 1.5937528 , 1.92008426]) | diff=array([-0.0262472 , -0.10991574])\n",
      "x=array([0.5171875, 0.4175   ]) | x_star=array([0.66455493, 1.03638747, 1.55744632, 2.04957956]) | diff=array([-0.06255368,  0.01957956])\n",
      "x=array([0.4984375, 0.4275   ]) | x_star=array([0.66686613, 1.03583925, 1.51473512, 2.17784369]) | diff=array([-0.10526488,  0.14784369])\n",
      "x=array([0.51367188, 0.414375  ]) | x_star=array([0.66411715, 1.03655487, 1.57199515, 2.00107693]) | diff=array([-0.04800485, -0.02892307])\n",
      "x=array([0.53085937, 0.411875  ]) | x_star=array([0.66325726, 1.03667474, 1.58309353, 1.97855706]) | diff=array([-0.03690647, -0.05144294])\n",
      "x=array([0.52734375, 0.40875   ]) | x_star=array([0.66286125, 1.03683271, 1.59810869, 1.93003499]) | diff=array([-0.02189131, -0.09996501])\n",
      "x=array([0.51972656, 0.4153125 ]) | x_star=array([0.66411481, 1.03650258, 1.56740929, 2.01973005]) | diff=array([-0.05259071, -0.01026995])\n",
      "x=array([0.50253906, 0.4178125 ]) | x_star=array([0.66499265, 1.03637827, 1.55668493, 2.04192436]) | diff=array([-0.06331507,  0.01192436])\n",
      "x=array([0.5237793 , 0.41335938]) | x_star=array([0.66368437, 1.03660228, 1.57629251, 1.9946361 ]) | diff=array([-0.04370749, -0.0353639 ])\n",
      "x=array([0.50961914, 0.41632813]) | x_star=array([0.66455012, 1.03645446, 1.56339191, 2.02569273]) | diff=array([-0.05660809, -0.00430727])\n",
      "x=array([0.52023926, 0.41410156]) | x_star=array([0.66389974, 1.03656561, 1.57293849, 2.00262416]) | diff=array([-0.04706151, -0.02737584])\n",
      "x=array([0.52629395, 0.41503906]) | x_star=array([0.66389701, 1.03651345, 1.56835008, 2.02126908]) | diff=array([-0.05164992, -0.00873092])\n",
      "x=array([0.53260498, 0.41537109]) | x_star=array([0.66378758, 1.03649268, 1.56653866, 2.03135067]) | diff=array([-0.05346134,  0.00135067])\n",
      "x=array([0.52578125, 0.41625   ]) | x_star=array([0.66411362, 1.03645011, 1.56300421, 2.03805401]) | diff=array([-0.05699579,  0.00805401])\n",
      "x=array([0.52162476, 0.41463867]) | x_star=array([0.66395247, 1.03653689, 1.57040439, 2.01156379]) | diff=array([-0.04959561, -0.01843621])\n",
      "x=array([0.52819214, 0.41436523]) | x_star=array([0.66373505, 1.03654765, 1.57134511, 2.01311218]) | diff=array([-0.04865489, -0.01688782])\n",
      "x=array([0.53242493, 0.4138916 ]) | x_star=array([0.66354525, 1.03657014, 1.57342261, 2.00959382]) | diff=array([-0.04657739, -0.02040618])\n",
      "x=array([0.53709412, 0.41429199]) | x_star=array([0.66348997, 1.03654671, 1.57125405, 2.01951915]) | diff=array([-0.04874595, -0.01048085])\n",
      "x=array([0.5448288 , 0.41411865]) | x_star=array([0.66325712, 1.03655199, 1.57197036, 2.02289562]) | diff=array([-0.04802964, -0.00710438])\n",
      "x=array([0.55095978, 0.41297119]) | x_star=array([0.6629098 , 1.0366076 , 1.57674026, 2.0118993 ]) | diff=array([-0.04325974, -0.0181007 ])\n",
      "x=array([0.56329269, 0.41193726]) | x_star=array([0.66241895, 1.03665393, 1.5811594 , 2.0068347 ]) | diff=array([-0.0388406, -0.0231653])\n",
      "x=array([0.57569656, 0.41216431]) | x_star=array([0.66213188, 1.03663565, 1.57949208, 2.02055396]) | diff=array([-0.04050792, -0.00944604])\n",
      "x=array([0.59733238, 0.41130066]) | x_star=array([0.66143039, 1.03666731, 1.5823268 , 2.02649632]) | diff=array([-0.0376732 , -0.00350368])\n",
      "x=array([0.61579628, 0.40911926]) | x_star=array([0.66060744, 1.03676537, 1.59160755, 2.01056159]) | diff=array([-0.02839245, -0.01943841])\n",
      "x=array([0.65128002, 0.40661957]) | x_star=array([0.65930885, 1.03686564, 1.60128464, 2.00516695]) | diff=array([-0.01871536, -0.02483305])\n",
      "x=array([0.68531971, 0.40598297]) | x_star=array([0.65833535, 1.03687592, 1.602188  , 2.02551776]) | diff=array([-0.017812  , -0.00448224])\n",
      "x=array([0.74633322, 0.40300583]) | x_star=array([0.65633869, 1.03697676, 1.61246693, 2.0360136 ]) | diff=array([-0.00753307,  0.0060136 ])\n",
      "x=array([0.80028086, 0.39832474]) | x_star=array([0.65433102, 1.03714747, 1.62826409, 2.02308261]) | diff=array([ 0.00826409, -0.00691739])\n",
      "x=array([0.89533405, 0.394711  ]) | x_star=array([0.65146795, 1.03723526, 1.63794491, 2.05846968]) | diff=array([0.01794491, 0.02846968])\n",
      "x=array([0.71229353, 0.40364243]) | x_star=array([0.65730277, 1.03696822, 1.61151538, 2.01567265]) | diff=array([-0.00848462, -0.01432735])\n",
      "x=array([0.83432055, 0.39768814]) | x_star=array([0.65338224, 1.03715298, 1.62883254, 2.04435203]) | diff=array([0.00883254, 0.01435203])\n",
      "x=array([0.74280028, 0.40215385]) | x_star=array([0.6563113 , 1.03701692, 1.61655139, 2.02125901]) | diff=array([-0.00344861, -0.00874099])\n",
      "x=array([0.68885264, 0.40683495]) | x_star=array([0.6583702 , 1.03683377, 1.59817282, 2.04031302]) | diff=array([-0.02182718,  0.01031302])\n",
      "x=array([0.7724238 , 0.40045229]) | x_star=array([0.6552842 , 1.03711075, 1.62200565, 2.02407119]) | diff=array([ 0.00200565, -0.00592881])\n",
      "x=array([0.76889087, 0.39960032]) | x_star=array([0.65526189, 1.03714967, 1.6248676 , 2.01187934]) | diff=array([ 0.0048676 , -0.01812066])\n",
      "x=array([0.75197263, 0.40215445]) | x_star=array([0.65607612, 1.03701139, 1.61597496, 2.02921361]) | diff=array([-0.00402504, -0.00078639])\n",
      "x=array([0.78159615, 0.40045289]) | x_star=array([0.65504934, 1.03710516, 1.62141196, 2.0320543 ]) | diff=array([0.00141196, 0.0020543 ])\n",
      "x=array([0.80099408, 0.3996024 ]) | x_star=array([0.65444028, 1.03713003, 1.62276948, 2.0398582 ]) | diff=array([0.00276948, 0.0098582 ])\n",
      "x=array([0.76114498, 0.40215505]) | x_star=array([0.65584122, 1.03700584, 1.6153984 , 2.03716795]) | diff=array([-0.0046016 ,  0.00716795])\n",
      "x=array([0.7696041 , 0.40087798]) | x_star=array([0.65544701, 1.03705954, 1.62064839, 2.02702115]) | diff=array([ 0.00064839, -0.00297885])\n",
      "x=array([0.79922762, 0.39917641]) | x_star=array([0.65446417, 1.03711484, 1.62459217, 2.03339245]) | diff=array([0.00459217, 0.00339245])\n",
      "x=array([0.76378638, 0.40140994]) | x_star=array([0.6556713 , 1.03703742, 1.61880204, 2.02887621]) | diff=array([-0.00119796, -0.00112379])\n",
      "x=array([0.77577843, 0.40098485]) | x_star=array([0.65530334, 1.03705116, 1.61988431, 2.03361186]) | diff=array([-0.00011569,  0.00361186])\n",
      "x=array([0.77114768, 0.4009047 ]) | x_star=array([0.65541108, 1.03705745, 1.62045728, 2.02866899]) | diff=array([ 0.00045728, -0.00133101])\n",
      "x=array([0.75333791, 0.40186175]) | x_star=array([0.65600083, 1.03702358, 1.6173862 , 2.02604753]) | diff=array([-0.0026138 , -0.00395247])\n",
      "x=array([0.77453159, 0.4008051 ]) | x_star=array([0.65531115, 1.03705973, 1.62058429, 2.03046873]) | diff=array([0.00058429, 0.00046873])\n",
      "x=array([0.78189289, 0.40029986]) | x_star=array([0.65502136, 1.0371116 , 1.62186435, 2.03067528]) | diff=array([0.00186435, 0.00067528])\n",
      "x=array([0.76831301, 0.40113242]) | x_star=array([0.65551801, 1.03704681, 1.61954979, 2.02946495]) | diff=array([-0.00045021, -0.00053505])\n",
      "x=array([0.77169692, 0.40103283]) | x_star=array([0.6554142 , 1.03705154, 1.61997973, 2.03061551]) | diff=array([-2.02694742e-05,  6.15506548e-04])\n",
      "x=array([0.77197153, 0.40109689]) | x_star=array([0.6554196 , 1.03704614, 1.61944901, 2.0322154 ]) | diff=array([-0.00055099,  0.0022154 ])\n",
      "x=array([0.76547833, 0.40136014]) | x_star=array([0.65562126, 1.03703858, 1.61888046, 2.02974507]) | diff=array([-0.00111954, -0.00025493])\n",
      "x=array([0.77226828, 0.40094386]) | x_star=array([0.65538764, 1.03705507, 1.62025032, 2.03009186]) | diff=array([2.50317983e-04, 9.18620127e-05])\n",
      "x=array([0.77565218, 0.40084427]) | x_star=array([0.65528773, 1.03705735, 1.62037733, 2.0318914 ]) | diff=array([0.00037733, 0.0018914 ])\n",
      "x=array([0.7701478 , 0.40106038]) | x_star=array([0.65545754, 1.03705128, 1.61998358, 2.02958565]) | diff=array([-1.64184776e-05, -4.14346763e-04])\n",
      "x=array([0.77071916, 0.40097142]) | x_star=array([0.65543098, 1.0370548 , 1.62025429, 2.02906167]) | diff=array([ 0.00025429, -0.00093833])\n",
      "x=array([0.77145248, 0.40101747]) | x_star=array([0.65541839, 1.03705236, 1.62004836, 2.03022705]) | diff=array([4.83594299e-05, 2.27052709e-04])\n",
      "x=array([0.77357295, 0.40090095]) | x_star=array([0.65534851, 1.03705614, 1.62031491, 2.03073383]) | diff=array([0.00031491, 0.00073383])\n",
      "x=array([0.77100409, 0.40102053]) | x_star=array([0.65543028, 1.03705249, 1.62006649, 2.02987245]) | diff=array([ 6.64906822e-05, -1.27553176e-04])\n",
      "x=array([0.77018829, 0.40109414]) | x_star=array([0.65546486, 1.03704734, 1.61957301, 2.03063329]) | diff=array([-0.00042699,  0.00063329])\n",
      "x=array([0.77174828, 0.40098143]) | x_star=array([0.65540599, 1.03705375, 1.62015389, 2.03007075]) | diff=array([1.53885408e-04, 7.07478285e-05])\n",
      "x=array([0.77129989, 0.40098448]) | x_star=array([0.65541787, 1.03705388, 1.62017203, 2.02971611]) | diff=array([ 0.00017203, -0.00028389])\n",
      "x=array([0.77141433, 0.40100923]) | x_star=array([0.65541826, 1.03705274, 1.62007928, 2.03009931]) | diff=array([7.92760611e-05, 9.93148581e-05])\n",
      "x=array([0.77067014, 0.40104832]) | x_star=array([0.65544255, 1.03705149, 1.61999186, 2.02990111]) | diff=array([-8.14279086e-06, -9.88914979e-05])\n",
      "x=array([0.77013107, 0.40108177]) | x_star=array([0.65546466, 1.03704792, 1.6196228 , 2.03043478]) | diff=array([-0.0003772 ,  0.00043478])\n",
      "x=array([0.77108038, 0.40103702]) | x_star=array([0.65543054, 1.03705173, 1.62000465, 2.03012794]) | diff=array([4.65400976e-06, 1.27940794e-04])\n",
      "x=array([0.77106131, 0.4010329 ]) | x_star=array([0.65543047, 1.03705192, 1.62002011, 2.03006407]) | diff=array([2.01129125e-05, 6.40666884e-05])\n",
      "x=array([0.77031712, 0.40107199]) | x_star=array([0.65545859, 1.03704823, 1.61964738, 2.03047885]) | diff=array([-0.00035262,  0.00047885])\n",
      "x=array([0.77114003, 0.40102492]) | x_star=array([0.65542739, 1.03705222, 1.62004263, 2.03004094]) | diff=array([4.26342683e-05, 4.09380292e-05])\n",
      "x=array([0.7715312 , 0.40100949]) | x_star=array([0.65541531, 1.03705266, 1.62007088, 2.03020394]) | diff=array([7.08776371e-05, 2.03935577e-04])\n",
      "x=array([0.7708854 , 0.40103861]) | x_star=array([0.65543574, 1.03705178, 1.62001162, 2.0299768 ]) | diff=array([ 1.16170167e-05, -2.31999004e-05])\n",
      "x=array([0.77096412, 0.40103063]) | x_star=array([0.65543265, 1.03705208, 1.62003414, 2.02995367]) | diff=array([ 3.41397438e-05, -4.63332143e-05])\n",
      "x=array([0.7707095 , 0.40104433]) | x_star=array([0.65544101, 1.03705164, 1.62000312, 2.02988954]) | diff=array([ 3.11956131e-06, -1.10462137e-04])\n",
      "x=array([0.7710324 , 0.40102977]) | x_star=array([0.65543079, 1.03705207, 1.62003276, 2.03000308]) | diff=array([3.27567670e-05, 3.08419557e-06])\n",
      "x=array([0.77095368, 0.40103775]) | x_star=array([0.65543388, 1.03705178, 1.62001023, 2.03002622]) | diff=array([1.02345193e-05, 2.62162917e-05])\n",
      "x=array([0.77080669, 0.40104659]) | x_star=array([0.65543883, 1.03705148, 1.61998909, 2.02999994]) | diff=array([-1.09065291e-05, -6.21627114e-08])\n",
      "x=array([0.77069383, 0.40105501]) | x_star=array([0.65544284, 1.03705118, 1.61996726, 2.02999837]) | diff=array([-3.27401646e-05, -1.62679345e-06])\n",
      "x=array([0.77073841, 0.40104746]) | x_star=array([0.65544069, 1.03705148, 1.61999048, 2.02995052]) | diff=array([-9.52460827e-06, -4.94769340e-05])\n",
      "x=array([0.77089986, 0.40104018]) | x_star=array([0.65543558, 1.0370517 , 1.6200053 , 2.03000729]) | diff=array([5.29503172e-06, 7.29203283e-06])\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       " final_simplex: (array([[0.77089986, 0.40104018],\n",
       "       [0.77080669, 0.40104659],\n",
       "       [0.7708854 , 0.40103861]]), array([9.01172036e-06, 1.09067063e-05, 2.59459141e-05]))\n",
       "           fun: 9.011720358810416e-06\n",
       "       message: 'Optimization terminated successfully.'\n",
       "          nfev: 84\n",
       "           nit: 44\n",
       "        status: 0\n",
       "       success: True\n",
       "             x: array([0.77089986, 0.40104018])"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def obj_func(x):\n",
    "    z, form = calibration(reliability2,Xk=3.0,beta_t=4.3,output=False,x=x)\n",
    "    x_star = form.getDesignPoint(False)\n",
    "    diff = x_star[2:] - np.array([1.62, 2.03]) # np.array([1.51, 2.25])\n",
    "    \n",
    "    print(f\"{x=} | {x_star=} | {diff=}\")\n",
    "    \n",
    "    return np.linalg.norm(diff)\n",
    "\n",
    "x_opt = minimize(obj_func,x0=[0.5,0.4],method='Nelder-Mead',bounds=[(0.1,1.2),(0.1,0.6)])\n",
    "x_opt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "3dcb12e9-4a93-40d8-a51b-c85184727673",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "μ = 0.9818462589784923, σ = 0.19450298564871332\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "d = pr.Gumbel(\"Q1\",0.89, 0.2)\n",
    "x_max = sample_maxima(d,2)\n",
    "l,s = gumbel_r.fit(x_max)\n",
    "μ,σ2 = gumbel_r.stats(loc=l,scale=s)\n",
    "print(f\"μ = {μ}, σ = {np.sqrt(σ2)}\")\n",
    "plt.hist(x_max);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "964b367f-8541-42eb-acbd-63494e248254",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "μ = 0.9841971900069314, σ = 0.3936093842398042\n"
     ]
    },
    {
     "data": {
      "image/png": "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0eTJk9XY2Njqfbrre1ZbjpXUfd+zBg8erBUrVqiyslLvvPOObr31Vt155506cOBAi+O71OvKMtT48eOtvLw8+3ZTU5OVlJRkFRUVtTj+u9/9rpWdnR2yLiMjw/rxj3/cofM0QbjH6umnn7bcbvdlmp25JFmbNm264JiHHnrIuvbaa0PW3XPPPVZWVlYHzsw8F3Os3nrrLUuS9Z///OeyzMlkDQ0NliSrvLy81THd+T3rf13MseI9K9Q3vvEN649//GOL27rS68rIMyinT59WZWWlMjMz7XXR0dHKzMxURUVFi/epqKgIGS9JWVlZrY7vKtpyrCTp5MmTGjp0qJKTky9Y491dd31dXYqxY8cqMTFRt912m/7xj39EejoR4ff7JUlxcXGtjuG19aWLOVYS71mS1NTUpA0bNqixsbHVfxamK72ujAyUTz/9VE1NTeddVTYhIaHVz7N9Pl9Y47uKthyrESNG6M9//rNeeeUV/fWvf1Vzc7NuuOEGffLJJ5djyp1Ka6+rQCCg//73vxGalZkSExO1bt06vfTSS3rppZeUnJysiRMn6t1334301C6r5uZmzZ8/XzfeeKNGjx7d6rju+p71vy72WHX396zq6mr169dPTqdTDzzwgDZt2qSUlJQWx3al11XELnWPyPF6vSH1fcMNN2jUqFH6/e9/r1/+8pcRnBk6sxEjRmjEiBH27RtuuEGHDh3SqlWr9Je//CWCM7u88vLytH//fr399tuRnorxLvZYdff3rBEjRqiqqkp+v18vvviicnNzVV5e3mqkdBVGnkEZOHCgYmJiVF9fH7K+vr5eHo+nxft4PJ6wxncVbTlWX9WzZ09dd911OnjwYEdMsVNr7XXlcrnUu3fvCM2q8xg/fny3el3l5+erpKREb731lgYPHnzBsd31PeuccI7VV3W39yyHw6Hhw4crPT1dRUVFSktL0+OPP97i2K70ujIyUBwOh9LT01VWVmava25uVllZWaufu3m93pDxklRaWtrq+K6iLcfqq5qamlRdXa3ExMSOmman1V1fV+2lqqqqW7yuLMtSfn6+Nm3apO3bt2vYsGFfe5/u+tpqy7H6qu7+ntXc3KxgMNjiti71uor0t3Rbs2HDBsvpdFrr16+33nvvPWvu3LlWbGys5fP5LMuyrFmzZlmLFy+2x//jH/+wevToYT322GPW+++/by1btszq2bOnVV1dHalduGzCPVbLly+3tm3bZh06dMiqrKy0ZsyYYfXq1cs6cOBApHbhsjlx4oS1d+9ea+/evZYk67e//a21d+9e6+OPP7Ysy7IWL15szZo1yx7/73//2+rTp4+1cOFC6/3337fWrFljxcTEWFu3bo3ULlw24R6rVatWWZs3b7Y+/PBDq7q62vrJT35iRUdHW2+++WakduGymTdvnuV2u60dO3ZYdXV19vLFF1/YY3jP+lJbjlV3fs9avHixVV5ebh0+fNjat2+ftXjxYisqKsp64403LMvq2q8rYwPFsizrySeftIYMGWI5HA5r/Pjx1u7du+1t3/72t63c3NyQ8S+88IJ1zTXXWA6Hw7r22mut11577TLPOHLCOVbz58+3xyYkJFjTpk2z3n333QjM+vI791PYry7njk9ubq717W9/+7z7jB071nI4HNaVV15pPf3005d93pEQ7rH6zW9+Y1111VVWr169rLi4OGvixInW9u3bIzP5y6yl4yQp5LXCe9aX2nKsuvN71g9/+ENr6NChlsPhsAYNGmRNmjTJjhPL6tqvqyjLsqzLd74GAADg6xn5HRQAANC9ESgAAMA4BAoAADAOgQIAAIxDoAAAAOMQKAAAwDgECgAAMA6BAgAAjEOgAAAA4xAoAADAOAQKAAAwDoECAACM8/8A0yIdpJnjrDwAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "d = pr.Gumbel(\"Q2\",0.77, 0.40)\n",
    "x_max = sample_maxima(d,2)\n",
    "l,s = gumbel_r.fit(x_max)\n",
    "μ,σ2 = gumbel_r.stats(loc=l,scale=s)\n",
    "print(f\"μ = {μ}, σ = {np.sqrt(σ2)}\")\n",
    "plt.hist(x_max);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6db0e584-3c73-4fbe-8e58-26a6a81f5302",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "pystra",
   "language": "python",
   "name": "pystra"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  },
  "toc-autonumbering": false,
  "toc-showcode": false,
  "toc-showmarkdowntxt": false
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
